<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Player</title>
  <style>
    :root { --bg:#000; --accent:#ffd400; --spinner-size:56px; }
    html,body{height:100%;margin:0;background:var(--bg);-webkit-font-smoothing:antialiased}
    .player-wrap{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}
    video#player{width:100%;height:100%;object-fit:contain;background:#000;display:block}

    /* minimal round spinner */
    .spinner {
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%);
      width:var(--spinner-size);
      height:var(--spinner-size);
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:200;
      pointer-events:none;
      filter: drop-shadow(0 6px 18px rgba(0,0,0,0.6));
    }
    .spinner .base {
      position:absolute;
      inset:0;
      border-radius:50%;
      border:5px solid rgba(255,255,255,0.08);
    }
    .spinner .arc {
      position:absolute;
      inset:0;
      border-radius:50%;
      border:5px solid transparent;
      border-top-color:var(--accent);
      border-right-color:rgba(255,255,255,0.95);
      transform-origin:50% 50%;
      animation:spin 1s linear infinite;
      box-shadow:0 0 8px rgba(255,212,0,0.06);
    }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    /* subtle pulsing while buffering */
    .spinner.buffer { animation: pulse 1.5s ease-in-out infinite; }
    @keyframes pulse {
      0% { transform: translate(-50%,-50%) scale(1); }
      50% { transform: translate(-50%,-50%) scale(1.06); }
      100% { transform: translate(-50%,-50%) scale(1); }
    }

    @media (max-width:520px){ :root { --spinner-size:44px; } }
  </style>
</head>
  <script
  type="text/javascript"
  src="//peelwrinkle.com/37/d7/1a/37d71a290dde379f3d1016fe3009fb4b.js"
></script>
<body>
  <div class="player-wrap" id="wrap">
    <video id="player" autoplay muted playsinline preload="auto" crossorigin></video>
    <div id="spinner" class="spinner" aria-hidden="true">
      <div class="base"></div>
      <div class="arc"></div>
    </div>
  </div>

  <!-- HLS.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.1.4/dist/hls.min.js"></script>
  <script>
  (function(){
    const source = "https://golu.allinonereborn.fun/hls_cors.php?key=mukesh"; // change if needed
    const video = document.getElementById('player');
    const spinner = document.getElementById('spinner');

    function showSpin(buf=false){ spinner.style.display='flex'; spinner.classList.toggle('buffer', !!buf); }
    function hideSpin(){ spinner.style.display='none'; spinner.classList.remove('buffer'); }

    // try keep autoplay chance high
    try { video.muted = true; video.volume = 0; video.playsInline = true; video.setAttribute('muted',''); video.setAttribute('playsinline',''); } catch(e){}

    // show spinner until actual playing event
    showSpin(true);

    async function attemptPlay() {
      try { video.muted = true; video.volume = 0; } catch(e){}
      const p = video.play();
      if (!p) return false;
      try { await p; return true; } catch(e){ return false; }
    }

    if (Hls.isSupported()) {
      const hls = new Hls({
        enableWorker: true,
        startFragPrefetch: true,     // aggressive first fragment prefetch
        lowLatencyMode: true,
        maxBufferLength: 4,
        backBufferLength: 8,
        liveSyncDurationCount: 2,
        manifestLoadingTimeOut: 6000,
        levelLoadingTimeOut: 6000,
        fragLoadingTimeOut: 8000,
        manifestLoadingMaxRetry: 4,
        maxFragRetry: 4
      });

      // attach before loading source (helps some browsers)
      hls.attachMedia(video);

      hls.on(Hls.Events.MANIFEST_LOADING, () => showSpin(true));
      hls.on(Hls.Events.MANIFEST_PARSED, async () => {
        // start load right away and try to play aggressively
        try { hls.startLoad(-1); } catch(e){}
        showSpin(true);
        const ok = await attemptPlay();
        if (ok) hideSpin();
      });

      hls.on(Hls.Events.FRAG_LOADING, () => showSpin(true));
      hls.on(Hls.Events.FRAG_LOADED, () => showSpin(true));
      hls.on(Hls.Events.FRAG_PARSED, () => showSpin(true));
      hls.on(Hls.Events.FRAG_BUFFERED, () => {
        // if playback started by browser it will fire playing -> hide spinner
        // otherwise keep spinner until playing event
        if (!video.paused && !video.seeking) hideSpin();
      });

      video.addEventListener('playing', () => hideSpin());
      video.addEventListener('waiting', () => showSpin(true));
      video.addEventListener('error', () => showSpin(false));

      hls.on(Hls.Events.ERROR, (evt, data) => {
        // recover quickly on recoverable errors, else reload
        if (data && data.fatal) {
          switch (data.type) {
            case Hls.ErrorTypes.NETWORK_ERROR:
              showSpin(true);
              try { hls.startLoad(); } catch(e){}
              break;
            case Hls.ErrorTypes.MEDIA_ERROR:
              showSpin(true);
              try { hls.recoverMediaError(); } catch(e){}
              break;
            default:
              // reload page quickly to re-init
              try { hls.destroy(); } catch(e){}
              setTimeout(()=> location.reload(), 800);
              break;
          }
        } else {
          showSpin(true);
        }
      });

      // load source after attach
      try { hls.loadSource(source); } catch(e){ showSpin(false); }
    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
      // native HLS (Safari)
      video.src = source;
      video.addEventListener('loadedmetadata', async () => {
        const ok = await attemptPlay();
        if (ok) hideSpin();
      });
      video.addEventListener('playing', () => hideSpin());
      video.addEventListener('waiting', () => showSpin(true));
      video.addEventListener('error', () => showSpin(false));
    } else {
      // unsupported
      hideSpin();
    }

    // user click anywhere should try to resume (no overlay shown)
    document.getElementById('wrap').addEventListener('click', async () => {
      const ok = await attemptPlay();
      if (ok) hideSpin();
    }, {passive:true});

    // ensure spinner visible until playing fires or 25s timeout -> then hide (avoid stuck forever)
    const timeout = setTimeout(()=>{ if (spinner) spinner.style.display='none'; }, 25000);
    video.addEventListener('playing', ()=> clearTimeout(timeout));
  })();
  </script>
</body>
  <script
  type="text/javascript"
  src="//peelwrinkle.com/63/88/ac/6388ace5c2a702a7b58f724683244363.js"
></script>
</html>
